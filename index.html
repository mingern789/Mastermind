<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Mastermind</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>

<body>
    <div id="app">
        <h1>Will you crack the code?</h1>
        <p>Inspired by the board game "Mastermind"</p>
        <p><b>Note:</b> A new random number will be generated on every refresh.</p>
        <label>Guess the 3 digit number</label>
        <input name="somename"
            oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
            type="number" maxlength="3" v-model="input" />
        <button v-on:click="submit">Submit</button>
        <h2>Chances left: {{lives}}</h2>
        <h2 style="margin-top: 20px;">Status</h2>
        <ol>
        <li v-for="i in status">{{i}}</li>
        </ol>

    </div>
</body>
<script>

    let app = new Vue({
        el: '#app',
        data: {
            input: "",
            status: [],
            lives:9
        },
        computed: {
            random: function () {
                return String(Math.floor(Math.random() * (1000 - 100) + 100));
            }
        },
        methods: {
            submit: function () {
                if (this.lives >= 1) {
                let counter = [];
                if (this.input.length < 3) {
                    alert("Please enter a 3 digit number.")
                }
                else {
                    if (this.input == this.random) {
                        alert("You cracked the code!")
                        this.status.push("You win! Refresh to start a new game.")
                    }
                    else  {
                        this.lives--;
                        for (var i = 0; i < this.input.length; i++) {
                            if (this.random.includes(this.input[i])) {
                                counter.push(true);
                            }
                            else {
                                counter.push(false)
                            }
                        }
                        if (!counter.includes(true)) {
                            this.status.push("None of the numbers are correct.")
                        }
                        else {
                            let truthcounter = 0;
                            let halfcounter = 0;
                            let falsecounter = 0;
                            let doppelganger = this.random;
                            for (var y = 0; y < this.input.length;y++) {
                                if (doppelganger[y] == this.input[y]) {
                                    truthcounter++;
                                    doppelganger = doppelganger.replace(doppelganger[y],'n')
                                    
                                }
                                else {
                                    continue
                                }
                            }
                            for (var i = 0 ; i < doppelganger.length; i++) {
                                if (doppelganger.includes(this.input[i])) {
                                    halfcounter++;
                                    
                                }
                                else {
                                    continue
                                }
                            }
                            this.status.push(`${truthcounter} number(s) is/are correct and in the right place, ${halfcounter} are correct but in wrong places.`)
                            
                        };
                    }
                }
            }
            else {
                alert(`You have run out of chances, the answer is ${this.random}. Refresh the page to try again.`)
            }
            } 

        }
    })
</script>

</html>